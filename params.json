{"name":"Play-swagger","tagline":"Swagger spec generator for play framework","body":"# Swagger API spec generator for Play \r\n\r\nA library that generates swagger specs from route files and case class reflection, no code annotation needed.  \r\n \r\n## Principles in this lib\r\n\r\n1. No code pollution (e.g. annotation) \r\n2. DRY (extract as much information from the code as possible)\r\n3. When documenting an endpoint, it should be just swagger specification that you need to write. You shall not need to learn another API or spec format.                 \r\n\r\nWhich translates to \r\n\r\n1. Write your [swagger specification](http://swagger.io/specification/) in your routes files as comments (json or yml)\r\n2. Reference your case classes in your swagger spec and play-swagger will generate definitions\r\n3. Override anything in either the swagger spec in comment or the base swagger spec file (swagger.yml or swagger.json in your conf)\r\n\r\n============================\r\n## Day-to-day usage \r\n\r\n#### A simple example\r\n\r\nIn a `cards.routes` which is referenced in `routes` as \r\n```\r\n->  /api/cards    cards.Routes\r\n```\r\nYou write the following swagger spec in comment. This example is in yml, you can write json if you prefer\r\n```\r\n ###\r\n #  summary: create a card \r\n #  responses:\r\n #    200:\r\n #      description: success\r\n #      schema:\r\n #        $ref: '#/definitions/com.iheart.api.Protocol.CardCreated'\r\n ###\r\n POST      /users/:profileId/contexts/:contextName/cards       controllers.api.Cards.createCard(profileId: Int, contextName: Option[String])\r\n\r\n```\r\n\r\nNote that everything in the comment is just standard swagger definition, and it $refs to a case class CardCreated, which is defined in a Protocol object, and it references another case class Card. Here is the source code:\r\n```scala\r\npackage com.iheart.api\r\n\r\nobject Protocol {\r\n  case class CardCreated(card: Card)\r\n  \r\n  case class Card(id: Int, name: String)\r\n}\r\n```\r\n\r\nThis will generate the path with summary, tags, parameters and a response with schema defined. It also recursively generates definitions from your case class.  \r\nThis works fine if you using a simple `Json.format[CardCreated]` to generate the json response out of this class. If not, you will have to write the definition yourself in the base swagger spec and reference it here at the endpoint. \r\n\r\nThe result swagger specs will look like:\r\n  ![](https://c2.staticflickr.com/6/5780/21599722125_971979b489_b.jpg)\r\n\r\n\r\n#### How to override?\r\nTo override any of the automatically generated field, you just need to write the same part in your comment or base swagger sepc file. \r\n\r\n#### How to hide an endpoint?\r\nIf you don't want an end point to be included, add `### NoDocs ###` in front of it \r\ne.g.\r\n```\r\n### NoDocs ###\r\nGET   /docs/swagger-ui/*file        controllers.Assets.at(path:String=\"/public/lib/swagger-ui\", file:String)\r\n```\r\n\r\n#### How to specify body content in a post \r\nBody content is specified as a special parameter in swagger. So you need to create a parameter in your swagger spec comment as \"body\", for example\r\n```\r\n###  \r\n#  parameters:\r\n#    - name: body\r\n#      schema:\r\n#        $ref: '#/definitions/com.iheart.api.Track'\r\n###\r\nPOST   /tracks       controller.Api.createTrack()\r\n```\r\nAgain, play-swagger will generate the definition for com.iheart.api.Track case class\r\n\r\n#### How to find more examples?\r\nIn the tests!\r\n/test/scala/com.iheart.playSwagger/SwaggerSpecGeneratorSpec.scala\r\n \r\n============================\r\n## Installation\r\n\r\nIn short you need to create a controller that uses the library to generate the swagger spec and make it available as an endpoint.\r\nThen you just need to have a swagger UI instance to consumer that swagger spec. \r\n  \r\n\r\n#### Step 1\r\nadd Swagger API dependency to your sbt\r\n```scala\r\nresolvers += Resolver.jcenterRepo\r\n\r\nlibraryDependencies +=  \"com.iheart\" %% \"play-swagger\" % \"0.1.1-RELEASE\"\r\n```\r\n\r\n#### Step 2\r\nadd a controller to your Play app that serves the swagger spec\r\n\r\n```scala\r\n\r\nclass ApiSpecs @Inject() (router: Router, cached: Cached) extends Controller {\r\n  implicit val cl = getClass.getClassLoader\r\n  \r\n  // The root package of your domain classes, PlaySwagger will automatically generate definitions when it encounters class references in this package.\r\n  // In our case it would be \"com.iheart\"\r\n  val domainPackage = \"YOUR.DOMAIN.PACKAGE\"  \r\n  private lazy val generator = SwaggerSpecGenerator(domainPackage)   \r\n\r\n  def specs = cached(\"swaggerDef\") {\r\n    Action { _ â‡’\r\n      Ok(generator.generate(router.documentation))\r\n    }\r\n  }\r\n\r\n}\r\n```\r\n\r\n#### Step 3\r\nadd an end point to the routes file \r\n```\r\n###\r\n# summary: swagger definition\r\n# description: for swagger UI to consume\r\n###\r\nGET   /docs/swagger.json         @controllers.swagger.ApiSpecs.specs\r\n\r\n```\r\n\r\n#### Step 4\r\nAdd a base swagger.yml (or swagger.json) to your resources folder. This one needs to provide all the required fields according to swagger spec\r\nE.g.\r\n```yml\r\n---\r\n  swagger: \"2.0\"\r\n  info: \r\n    title: \"Poweramp API\"\r\n    description: \"Power your music\"\r\n    version: \"1.0.0\"\r\n  host: api2.iheart.com\r\n  schemes:\r\n    - \"https\"\r\n  consumes:\r\n    - application/json\r\n  produces: \r\n    - application/json\r\n\r\n```\r\n\r\n#### Step 5a\r\nDeploy a swagger ui and point to the swagger spec end point, or\r\n\r\n#### Step 5b\r\nAlternatively you can use swagger-ui webjar and have you play app serving the swagger ui:\r\n\r\nAdd the following dependency\r\n```scala\r\nlibraryDependencies += \"org.webjars\" % \"swagger-ui\" % \"2.1.2\"\r\n```\r\n\r\nAdd the following to your route file\r\n```\r\n### NoDocs ###\r\nGET   /docs/swagger-ui/*file        controllers.Assets.at(path:String=\"/public/lib/swagger-ui\", file:String)\r\n\r\n```\r\n\r\nThen you should be able to open the swagger ui at\r\nhttp://localhost:9000/docs/swagger-ui/index.html?url=/docs/swagger.json\r\n\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}